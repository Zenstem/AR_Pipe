<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>정적 지도</title>
    
</head>
<body>
<div id="staticMap" style="width:1920px;height:1920px;"></div>
<p>
    <button onclick="getImageURL()">GetURL</button>
    <textarea id="textArea" cols="50" rows="10"></textarea>
</p>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b5d34509ba7357aff65190a05cf70747"></script>
<script>
var staticMapContainer = document.getElementById('staticMap'), // 지도를 표시할 div 
    staticMapOption = { 
        center: new kakao.maps.LatLng(36.39244828, 127.40692625), // 지도의 중심좌표
        level: 1 // 지도의 확대 레벨
    };

var map = new kakao.maps.StaticMap(staticMapContainer, staticMapOption); // 지도를 생성합니다
map.setMapTypeId(kakao.maps.MapTypeId.HYBRID);
</script>

<script src="html2canvas.js"></script>
<--script>
  //이미지(png)로 다운로드
  function getImageURL(){
      window.scrollTo(0, 0);
      html2canvas(document.getElementById('staticMap')).then(function(canvas){
          var staticMapImageURL = canvas.toDataURL();
          document.getElementById('textArea').innerHTML = staticMapImageURL;
      });
  }
</script-->

<script>
  //이미지(png)로 다운로드
  function getImageURL(){
  let mapLoad = encodeBase64ImageTagviaCanvas("https://spi.maps.daum.net/map2/map/skyviewimageservice?RDR=HybridRender&IW=1920&IH=1920&MX=591268&MY=804171&SCALE=0.625&service=open");
  mapLoad.then(function(mapCanvas)
{
  html2canvas(mapCanvas).then(function(canvasImg){
          var staticMapImageURL = canvasImg.toDataURL();
          document.getElementById('textArea').innerHTML = staticMapImageURL;
      });
});
  }

function encodeBase64ImageTagviaCanvas (url) {
  return new Promise((resolve, reject) => {
    let image = new Image();
    image.onload = () => {
      var canvas = document.createElement('canvas');
      // or 'width' if you want a special/scaled size
      canvas.width = image.naturalWidth;
      // or 'height' if you want a special/scaled size
      canvas.height = image.naturalHeight;
      canvas.getContext('2d').drawImage(image, 0, 0);

      //let uri = canvas.toDataURL('image/png');
      resolve(canvas);
    }
    image.src = url;
  });
}
</script>

</body>
</html>